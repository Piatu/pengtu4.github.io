"use strict";(self["webpackChunkthree"]=self["webpackChunkthree"]||[]).push([[450],{6714:function(t,s,e){e.d(s,{Z:function(){return r}});var i=function(){var t=this,s=t._self._c;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"dialog"},[s("div",{staticClass:"dialog-wrap"},[s("div",{staticClass:"dialog-header"},[t._t("header"),s("button",{staticClass:"dialog-header-close",on:{click:t.close}},[t._v("X")])],2),s("div",{staticClass:"dialog-body"},[t._t("default")],2),s("div",{staticClass:"dialog-footer"},[t._t("footer")],2)])])},a=[],c={name:"Dialog",props:{visible:{type:Boolean,required:!0}},methods:{close(){this.$emit("update:visible",!1)}}},n=c,l=e(3736),o=(0,l.Z)(n,i,a,!1,null,"7721ecac",null),r=o.exports},2450:function(t,s,i){i.r(s),i.d(s,{default:function(){return v}});var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart"},[s("h4",[t._v("全部商品")]),s("div",{staticClass:"cart-main"},[t._m(0),s("div",{staticClass:"cart-body"},t._l(t.cartInfoList,(function(e){return s("ul",{key:e.id,staticClass:"cart-list"},[s("li",{staticClass:"cart-list-con1"},[s("input",{attrs:{type:"checkbox",name:"chk_list"},domProps:{checked:!!e.isChecked},on:{change:function(s){return t.checkCartInfo(e)}}})]),s("li",{staticClass:"cart-list-con2"},[s("img",{attrs:{src:e.imgUrl}}),s("div",{staticClass:"item-msg"},[t._v(t._s(e.skuName))])]),s("li",{staticClass:"cart-list-con4"},[s("span",{staticClass:"price"},[t._v(t._s(e.skuPrice))])]),s("li",{staticClass:"cart-list-con5"},[s("a",{staticClass:"mins",attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.changeSkuNum("decrement",e)}}},[t._v("-")]),s("input",{staticClass:"itxt",attrs:{autocomplete:"off",type:"text",minnum:"1"},domProps:{value:e.skuNum},on:{change:function(s){return t.changeSkuNum("change",e,s)}}}),s("a",{staticClass:"plus",attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.changeSkuNum("increment",e)}}},[t._v("+")])]),s("li",{staticClass:"cart-list-con6"},[s("span",{staticClass:"sum"},[t._v(t._s(e.skuPrice*e.skuNum))])]),s("li",{staticClass:"cart-list-con7"},[s("a",{staticClass:"sindelet",attrs:{href:"javascript:;"},on:{click:function(s){return t.showDialogByOneInfo(e.skuId)}}},[t._v("删除")]),s("br"),s("a",{attrs:{href:"#none"}},[t._v("移到收藏")])])])})),0)]),s("div",{staticClass:"cart-tool"},[s("div",{staticClass:"select-all"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checkAll,expression:"checkAll"}],staticClass:"chooseAll",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.checkAll)?t._i(t.checkAll,null)>-1:t.checkAll},on:{change:function(s){var e=t.checkAll,i=s.target,a=!!i.checked;if(Array.isArray(e)){var c=null,n=t._i(e,c);i.checked?n<0&&(t.checkAll=e.concat([c])):n>-1&&(t.checkAll=e.slice(0,n).concat(e.slice(n+1)))}else t.checkAll=a}}}),s("span",[t._v("全选")])]),s("div",{staticClass:"option"},[s("a",{attrs:{href:"javascript:;"},on:{click:t.showDialogBySelectd}},[t._v("删除选中的商品")]),s("a",{attrs:{href:"#none"}},[t._v("移到我的关注")]),s("a",{attrs:{href:"#none"}},[t._v("清除下柜商品")])]),s("div",{staticClass:"money-box"},[s("div",{staticClass:"chosed"},[t._v("已选择 "),s("span",[t._v(t._s(t.selectedCount))]),t._v("件商品 ")]),s("div",{staticClass:"sumprice"},[s("em",[t._v("总价（不含运费） ：")]),s("i",{staticClass:"summoney"},[t._v(t._s(t.selecteMoney))])]),s("div",{staticClass:"sumbtn"},[s("router-link",{staticClass:"sum-btn",attrs:{to:"/trade"}},[t._v("结算")])],1)])]),s("Dialog",{attrs:{visible:t.visible},on:{"update:visible":function(s){t.visible=s}},scopedSlots:t._u([{key:"header",fn:function(){return[t._v(" 提示 ")]},proxy:!0},{key:"footer",fn:function(){return[s("div",{staticClass:"btn-footer"},[s("button",{staticClass:"btn",on:{click:function(s){t.visible=!1}}},[t._v("取消")]),s("button",{staticClass:"btn primary",on:{click:t.deleteShopCart}},[t._v("确认")])])]},proxy:!0}])},[[s("p",[t._v("你真的要删除"),s("span",{staticStyle:{color:"red"}},[t._v(t._s(t.isDelOne?"这条":"这些选中的"))]),t._v("数据")])]],2)],1)},c=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart-th"},[s("div",{staticClass:"cart-th1"},[t._v("全部")]),s("div",{staticClass:"cart-th2"},[t._v("商品")]),s("div",{staticClass:"cart-th3"},[t._v("单价（元）")]),s("div",{staticClass:"cart-th4"},[t._v("数量")]),s("div",{staticClass:"cart-th5"},[t._v("小计（元）")]),s("div",{staticClass:"cart-th6"},[t._v("操作")])])}],n=i(997),l=i(6714),o=i(8366),r={name:"ShopCart",components:{Dialog:l.Z},data(){return{cartInfoList:[],visible:!1,skuId:0,isDelOne:!1,skuIdList:[],leaveCartInfoList:[],timeId:"",num:0}},async mounted(){const t=await(0,n.rV)();200===t.code?(console.log(t),this.cartInfoList=t.data[0].cartInfoList):console.log(t.message)},methods:{async checkCartInfo(t){let s=1-t.isChecked;await(0,n.th)(t.skuId,s);t.isChecked=s},showDialogByOneInfo(t){this.visible=!0,this.skuId=t,this.isDelOne=!0},async deleteOne(){if(this.isDelOne){const t=await(0,n.VI)(this.skuId);200===t.code?(this.visible=!1,this.cartInfoList=this.cartInfoList.filter((t=>t.skuId!==this.skuId))):console.log(t.message)}else;},showDialogBySelectd(){this.leaveCartInfoList=[],this.visible=!0,this.cartInfoList.forEach((t=>{t.isChecked?this.skuIdList.push(t.skuId):this.leaveCartInfoList.push(t)})),this.isDelOne=!1},async deleteShopCart(){if(this.isDelOne){const t=await(0,n.VI)(this.skuId);return void(200===t.code?(this.visible=!1,this.cartInfoList=this.cartInfoList.filter((t=>t.skuId!==this.skuId))):console.log(t.message))}const t=await(0,n.Hj)(this.skuIdList);200===t.code?(this.visible=!1,this.cartInfoList=this.leaveCartInfoList):console.log(t.message)},async changeSkuNum(t,s,i){let a=0,{skuId:c,skuNum:l}=s;switch(t){case"increment":this.num++,s.skuNum++,s.skuNum>200&&(s.skuNum=200,this.num=0);break;case"decrement":this.num--,s.skuNum--,s.skuNum<1&&(s.skuNum=1,this.num=0);break;case"change":let t=i.target.value,a=s.skuNum;o.zl.test(t)?(this.num=t-s.skuNum,s.skuNum=t,t>200&&(this.num=200-a,s.skuNum=200)):e.target.value=a;break}this.timeId&&clearTimeout(this.timeId),this.timeId=setTimeout((async()=>{if(0===this.num)return;const t=await(0,n.v2)(c,a);200===t.code?(this.num=0,console.log("更改数据成功...")):console.log("更改数据失败...")}),500)}},computed:{checkAll:{get(){return this.cartInfoList.every((t=>1===t.isChecked))},async set(t){const s=[];let e=t?1:0;this.cartInfoList.forEach((t=>{t.isChecked=e,s.push(t.skuId)}));const i=await(0,n.vz)(e,s);200===i.code?alert("更新成功.."):console.log("更新失败...")}},selectedCount(){return this.cartInfoList.reduce(((t,s)=>t+s.isChecked),0)},selecteMoney(){return this.cartInfoList.reduce(((t,s)=>t+s.isChecked*s.skuPrice*s.skuNum),0)}},watch:{visible:{immediate:!0,handler(){this.visible?document.documentElement.style.overflow="hidden":document.documentElement.style.overflow="auto"}}}},u=r,h=i(3736),d=(0,h.Z)(u,a,c,!1,null,"54df9cd6",null),v=d.exports},8366:function(t,s,e){e.d(s,{P$:function(){return a},QQ:function(){return n},VW:function(){return c},zl:function(){return i}});const i=/^[1-9]\d{0,2}$/,a=/^1[3-578]\d{9}$/,c=/^\d{6}$/,n=/^[A-Za-z0-9_%#@.]{6,8}$/}}]);
//# sourceMappingURL=450.1bf7502d.js.map